# Levy_et_al_MCP_2022
Large-Scale Immuno-Peptidome Analysis Reveals Recurrent Post-Translational Splicing of Cancer and Immune-Associated Genes

**Program#1: Arrange.msms.inputs.py**
This program arranges input files for continuation with the other scripts below.

Inputs: 
MaxQuant peptides.txt and msms.txt output files should be saved in a workdir

How to run: 
python Arrange.msms.inputs.py $workdir
$workdir is the name of your workdir

All outputs are saved in the same workdir 

**Program#2: Fragmentation.pl**
The script calculates the MS2 %fragmentation coverage of peptides. It calculateshow many positions along the peptide sequence get fragmented out of the total number of possible positions.

Input file: 
Input should contain 3 columns, tab-delimited:
Column1: Free text (for example it can contain 'raw file name'@'msms ID' as shown below)
Column2: peptide
Column3: ions(matches) in the format of MaxQuant

Tab-delimited input file example (can be generated by Arrange.msms.inputs.py):

 <br>QEP2_13046_YSA_921_1_301220@1 AAAAAAAAATN y8;y9;b3;b4;b5;b6;b7;b8;b9
<br>QEP2_13046_YSA_917_1_301220@2 AAAAAAAAAW  y1;y2;y3;y9(2+);a2;b2;b3;b4;b5;b6;b7;b8;b6(2+);b7(2+);b8(2+)
<br>QEP2_13046_YSA_917_1_301220@3 AAAAAAAAAW  y1;y2;a2;b2;b3;b4;b5;b6;b7;b8;b6(2+);b8(2+)
<br>QEP2_13046_YSA_917_1_301220@4 AAAAAAAAAW  y1;y2;y3;y4;y5;y6;b2;b3;b4;b5;b6;b7;b8;b9
<br>QEP2_13046_YSA_918_1_301220@5 AAAAAAAAAW  y1;y2;y3;a2;b2;b3;b4;b5;b6;b7;b8;b6(2+);b8(2+)
<br>QEP2_13046_YSA_918_1_301220@6 AAAAAAAAAW  y1;y2;y3;y5;b2;b3;b4;b5;b6;b7;b8;b9

How to run: 
perl Fragmentation.pl $workdir > $workdir/fragmentation.output.txt

**Program#3: Ambiguity.pl**

This program checks peptide ambiguity, by analyzing the alternative peptides explaining the spectra. In case an alternative peptide exists with a similar score (delta score less than 20), it is checked in uniprot. If the alternative is a WT sequence in Uniprot, the peptide is outputted.

oneline.UP000005640.nr.fa containes the human uniprot sequences, each in a one-line. The format is tab-delimited as shown below:

>uniprot header        sequence

In addition, an input file is required with the msms data.
It can be generated by Arrange.msms.inputs.py, which takes "All sequences" column from MaxQuant msms file, without decoys.
This input file should be in following format:
freetext(can be raw file name@msms ID)    Sequence        Score   All scores      All sequences

#tab-delimited input example:
<br>QEP2_13046_YSA_921_1_301220@1   AAAAAAAAATN     67.032  67.03204;32.32016;29.14901      AAAAAAAAATN;TGPAAVNATN;PSAAAPAAYP
<br>QEP2_13046_YSA_917_1_301220@2   AAAAAAAAAW      75.109  75.10919;41.50215;36.39517      AAAAAAAAAW;AAGQIQAW;SGQKPAAW
<br>QEP2_13046_YSA_917_1_301220@3   AAAAAAAAAW      63.565  63.56507;37.55836;37.55836      AAAAAAAAAW;SGQKPAAW;FQAATGHL
<br>QEP2_13046_YSA_917_1_301220@4   AAAAAAAAAW      101.23  101.2281;49.58986;46.01568      AAAAAAAAAW;SGQKPAAW;ASGKPGAAW


How to run: 
perl Ambiguity.pl $workdir > $workdir/peptide.ambiguity.txt

**Program #4: RT_linear_model.R**

This program uses the retention times and caluclates for each raw file a general linear model based on retention time versus hydrophobicy index (HI). HI is calculated based on the peptide sequence using specL R library. outliers are identified in each raw file, based on the lower and upper quantiles.

Tab-delimited Input file example (can be generates also by Arrange.msms.inputs.py):

<br>Raw file        RID     Sequence        Retention time
<br>Seq57470_QE3    Seq57470_QE3@0  AAAAAAAAAAA     35.647
<br>QEP2_13046_YSA_921_1_301220     QEP2_13046_YSA_921_1_301220@1   AAAAAAAAATN     56.869
<br>QEP2_13046_YSA_917_1_301220     QEP2_13046_YSA_917_1_301220@2   AAAAAAAAAW      60.989
<br>QEP2_13046_YSA_917_1_301220     QEP2_13046_YSA_917_1_301220@3   AAAAAAAAAW      61.342
<br>QEP2_13046_YSA_917_1_301220     QEP2_13046_YSA_917_1_301220@4   AAAAAAAAAW      61.251
<br>QEP2_13046_YSA_918_1_301220     QEP2_13046_YSA_918_1_301220@5   AAAAAAAAAW      60.831

How to run: 
Rscript RT_linear_model.R $workdir
